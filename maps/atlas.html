<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="../images/logo_estrella.png">
	<meta name="description" content="" />
	<meta name="keywords" content="bootstrap, bootstrap5" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="../fonts/icomoon/style.css">
	<link rel="stylesheet" href="../fonts/flaticon/font/flaticon.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
	
	<link rel="stylesheet" href="../css/aos.css">
	<link rel="stylesheet" href="../css/glightbox.min.css">
	<link rel="stylesheet" href="../css/style.css">
	<link rel="stylesheet" href="../css/flatpickr.min.css">
	<link rel="stylesheet" type="text/css" href="../dist/css/tabby-ui.css">
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
	integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
	crossorigin=""/>
	<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
	integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
	crossorigin=""></script>



<link rel="stylesheet" href="https://unpkg.com/leaflet@0.7.7/dist/leaflet.css" />

		<script src="Leaflet.CountrySelect.js"></script>
	
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<title>SIGEH | Gobierno del Estado de Hidalgo</title>
	<style>
		html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    width: 100%;
	

}

	</style>
</head>
<body>
	<div class="container2">
		<div class="head_map">
			<img src="../images/logo_estrella.png" alt="Logo" class="logo">
			<h1>Atlas interactivo del Estado de Hidalgo</h1>
		</div>
		<div class="Mapa" id="map"></div>
		<div class="leyenda">
			<div class="iconos1">
				<div class="logo-div" style="border-top: 1px solid white;"><img src="../images/logos/ambiente.png" alt="Logo 1" class="icono"><span class="icon-text">Medio Ambiente</span></div>
				<div class="logo-div"><img src="../images/logos/finanzas.png" alt="Logo 2" class="icono"><span class="icon-text">Desarrollo Económico</span></div>
				<div class="logo-div"><img src="../images/logos/vivienda.png" alt="Logo 3" class="icono"><span class="icon-text">Población y vivienda</span></div>
				<div class="logo-div"><img src="../images/logos/educacion.png" alt="Logo 4" class="icono"><span class="icon-text">Educación y cultura</span></div>
				<div class="logo-div"><img src="../images/logos/l-04.png" alt="Logo 5" class="icono"><span class="icon-text">Infraestructura</span></div>
				<div class="logo-div"><img src="../images/logos/movilidad.png" alt="Logo 6" class="icono"><span class="icon-text">Movilidad y transporte</span></div>
				<div class="logo-div"><img src="../images/logos/proteccion.png" alt="Logo 7" class="icono"><span class="icon-text">Protección civil</span></div>
				<div class="logo-div"><img src="../images/logos/seguridad.png" alt="Logo 8" class="icono"><span class="icon-text">Seguridad</span></div>
				<div class="logo-div"><img src="../images/logos/salud.png" alt="Logo 9" class="icono"><span class="icon-text">Salud</span></div>
				<div class="logo-div"><img src="../images/logos/social.png" alt="Logo 10" class="icono"><span class="icon-text">Desarrollo social</span></div>
				<div class="logo-div"><img src="../images/logos/cultura.png" alt="Logo 11" class="icono"><span class="icon-text">Turismo</span></div>
				<div class="logo-div"><img src="../images/logos/gobierno.png" alt="Logo 12" class="icono"><span class="icon-text">Gobierno y transparencia</span></div>
			</div>
			<div class="leyenda1">
				<h2>Simbología</h2>
				<div id="layer-control"></div>
				<div id="map-legend"></div>
			</div>
			
		</div>
	</div>
	
	
	  <script src="capas/capas.js"></script>
	  <script>
		  
	  var map = L.map('map', {zoomControl: false}).setView([20.5791, -98.9621,], 9);
	  
	  
	  
	  L.tileLayer('https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png', {
	  }).addTo(map);
	  
	  L.control.zoom({
		   position: 'bottomleft'
	  }).addTo(map);
	  
	  
	  
	  var geojsonLayer = L.geoJSON(municipios, {
		  style: function(feature) {
			  return {
				  fillColor: '#9f2241',  // color del relleno
				  fillOpacity: 0.8,  // transparencia del relleno (0-1)
				  color: 'white',  // color de la línea
				  weight: 1,  // grosor de la línea
				  opacity: 1  // transparencia de la línea (0-1)
			  };
		  },
		  onEachFeature: function(feature, layer) {
			  feature.layer=layer;
			  layer.on({
				  mouseover: function(e) {
					  var layer = e.target;
					  layer.setStyle({
						  fillColor: '#ddc9a3',  // color del relleno al hacer hover
						  color: 'white',  // color de la línea al hacer hover
					  });
					  layer.bindPopup(feature.properties.NOMGEO).openPopup();
				  },
				  mouseout: function(e) {
					  var layer = e.target;
					  geojsonLayer.resetStyle(layer);  // restablecer el estilo original
					  layer.closePopup();
				  },
				  click: function(e) {
					  // Abrir el PDF en una nueva ventana o pestaña
					  window.open(feature.properties.link);
				  }
			  });
		  }
	  }).addTo(map);
	  
	  
	  /*var searchControl = new L.Control.Search({
			 layer: geojsonLayer,
			 propertyName: 'NOMGEO',
			 circleLocation: true,
			 position: 'topright',
			 collapsed: false,
			 zoom:12,
			 textPlaceholder:'                   Busca aquí algún municipio  ',
			 marker: {
				 circle: {
					 color: 'white',  // Color del borde del círculo
					 fillColor: 'white',  // Color de relleno del círculo
					 fillOpacity: 0.5,  // Opacidad del relleno
					 radius: 30  // Radio del círculo en pixeles
				 }
			 }
	  });
	  map.addControl(searchControl);*/
	  
	  //Lista desplegable
	  var select = L.countrySelect();
	  
	  select.addTo(map);
				  
	  select.on('change', function(e){
		  if (e.feature === undefined){ // Do nothing on title
			  return;
		  }
	  
		  // Establece el estilo para la característica seleccionada
		  var selectedStyle = {
			  "color": "#bc955c",
			  "weight": 10,
			  "opacity": 0.9,
			  "fill": false,       // No relleno
			  "fillOpacity": 0 ,    // Relleno transparente
		  };
	  
		  var country = L.geoJson(e.feature, {
			  style: selectedStyle
		  });
	  
		  // Elimina cualquier capa anterior antes de agregar la nueva
		  if (this.previousCountry != null) {
			  map.removeLayer(this.previousCountry);
		  }
		  
		  this.previousCountry = country;
	  
		  // Agrega la característica al mapa y ajusta el zoom a sus límites
		  country.addTo(map);
		  map.fitBounds(country.getBounds());
	  });
	  
	  document.addEventListener('DOMContentLoaded', (event) => {
		  Swal.fire({
			  title: 'Infografías Municipales',
			  showClass: {
				  popup: 'animate__animated animate__fadeInDown'
			  },
			  hideClass: {
				  popup: 'animate__animated animate__fadeOutUp'
			  },
			  confirmButtonText: 'Entrar',
			  confirmButtonColor: '#bc955c',   // color del botón
			  background: 'linear-gradient(45deg,#691c32 , #9f2241',         // color de fondo del modal
			  titleText: 'Bienvenido al Atlas interactivo del Estado de Hidalgo | Selecciona un sector de la columna izquierda para poder visualizar sus capas',            // color del texto del título
		  })
	  });
	 // ... (tu código anterior) ...

// Añadir control de capas
var baseLayers = {
    "OpenStreetMap": L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }),
    "Terreno": L.tileLayer('https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png', {
	maxZoom: 20,
	attribution: '<a href="https://github.com/cyclosm/cyclosm-cartocss-style/releases" title="CyclOSM - Open Bicycle render">CyclOSM</a> | Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}),
    "Imágen satelital": L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        subdomains: 'abcd',
        minZoom: 1,
        maxZoom: 16,
        ext: 'jpg'
    }),
	"Noche": L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	subdomains: 'abcd',
	maxZoom: 20}),
};


var overlays = {
    "Municipios": geojsonLayer
};

// Crear el control de capas y añadirlo al div "leyenda1"
var layersControl = L.control.layers(baseLayers, overlays, {
    collapsed: false
}).addTo(map);

document.querySelector('.leyenda1').appendChild(layersControl.getContainer());
var capasTitle = document.createElement('div');
capasTitle.innerHTML = '<strong>Capas</strong>';
capasTitle.style.backgroundColor = '#691c32';
capasTitle.style.color = 'white';
capasTitle.style.padding = '5px 10px';
capasTitle.style.borderTopLeftRadius = '4px';
capasTitle.style.borderTopRightRadius = '4px';
layersControl.getContainer().insertBefore(capasTitle, layersControl.getContainer().firstChild);

// Añadir leyenda personalizada
var legend = L.control({position: 'bottomleft'});

legend.onAdd = function(map) {
    var div = L.DomUtil.create('div', 'info legend');
    div.innerHTML = '<strong>Simbología</strong><br><i style="background: #9f2241"></i> Municipios<br>';
    return div;
};

legend.addTo(map);  // Añade la leyenda al mapa

// Mueve el contenedor de la leyenda al div 'leyenda1'
document.querySelector('.leyenda1').appendChild(legend.getContainer());

// Mostrar la leyenda si la capa de municipios está activa al cargar el mapa
if (map.hasLayer(geojsonLayer)) {
    legend.getContainer().style.display = '';
} else {
    legend.getContainer().style.display = 'none';
}

// Mostrar la leyenda cuando la capa de municipios esté activa
map.on('overlayadd', function(event) {
    if (event.name === 'Municipios') {
        legend.getContainer().style.display = '';
    }
});

// Ocultar la leyenda cuando la capa de municipios esté desactivada
map.on('overlayremove', function(event) {
    if (event.name === 'Municipios') {
        legend.getContainer().style.display = 'none';
    }
});






	  </script>	
</body>
</html>